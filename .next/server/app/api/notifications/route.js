"use strict";(()=>{var e={};e.id=1996,e.ids=[1996],e.modules={92509:e=>{e.exports=require("firebase-admin")},60325:e=>{e.exports=require("firebase-admin/app")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63524:(e,a,n)=>{n.r(a),n.d(a,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>u});var i={};n.r(i),n.d(i,{POST:()=>c});var r=n(49303),t=n(88716),s=n(60670),o=n(87070),m=n(6128);async function c(e){try{let a=await e.json();return await (0,m.sendAdminNotification)(a),o.NextResponse.json({success:!0,message:"Notification sent."})}catch(e){return console.error("API Error in /api/notifications:",e),o.NextResponse.json({message:e.message||"Internal Server Error"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/notifications/route",pathname:"/api/notifications",filename:"route",bundlePath:"app/api/notifications/route"},resolvedPagePath:"/root/app/src/app/api/notifications/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:u,serverHooks:l}=p,g="/api/notifications/route";function v(){return(0,s.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:u})}},6128:(e,a,n)=>{n.d(a,{FH:()=>p,IW:()=>m,y3:()=>c});var i=n(92509),r=n.n(i),t=n(60325),s=n(89155);let o=null;function m(){if(!o)throw Error("Firebase Admin SDK is not initialized. Check server logs and environment variables.");return o}!function(){if(o)return;let e=process.env.FIREBASE_PRIVATE_KEY;if(!e||!process.env.FIREBASE_CLIENT_EMAIL){console.error("CRITICAL ERROR: Firebase Admin credentials are not fully set in environment variables. Admin features will fail.");return}let a={projectId:"studio-8506488239-824d2",clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:e.replace(/\\n/g,"\n")};try{let e=(0,t.getApps)().length?(0,t.getApps)()[0]:r().initializeApp({credential:r().credential.cert(a),databaseURL:"https://studio-8506488239-824d2.firebaseio.com"});o={adminApp:e,adminDb:r().firestore(e),adminAuth:r().auth(e)},console.log("Firebase Admin SDK initialized successfully.")}catch(e){console.error("Firebase Admin SDK initialization error:",e.message)}}();let c=e=>{let{adminAuth:a}=m();return a.verifyIdToken(e)},p=async(e,a)=>{let{adminDb:n}=m(),i=await c(e),r=(await n.doc(`users/${i.uid}`).get()).data();if(!r)throw Error(`Permission Denied: User with UID ${i.uid} not found in Firestore.`);let t=r.role;if(!t||!s._[t])throw Error(`Permission Denied: User role '${t}' is not defined or has no permissions.`);if(!s._[t]?.includes(a))throw Error(`Permission Denied: User with role '${t}' does not have the required '${a}' permission.`);return!0}},89155:(e,a,n)=>{n.d(a,{_:()=>i});/**
 * @project Engraced Smiles
 * @author Daniel Innocent <@mdtbmw>
 * @copyright Copyright (c) 2024. All rights reserved.
 * This software is the exclusive property of Daniel Innocent.
 * A license has been granted to Mr. Ismail Muhammed for resale to Engraced Smiles.
 */let i={Manager:["viewDashboard","viewOperations","viewFinancials","viewAnalytics","manageShipments","manageUsers","manageDrivers","viewMore","manageAccount","manageTeam","managePayouts","managePayments","sendNotifications","viewReports","manageTemplates","managePrograms","managePromotions","manageSupport","manageEmergencies","manageSettings","manageFrontend","manageSystem","viewMarketing","manageInventory"],Support:["viewDashboard","viewOperations","manageShipments","manageUsers","manageDrivers","viewMore","manageAccount","manageSupport","manageEmergencies"],Finance:["viewDashboard","viewFinancials","viewAnalytics","viewMore","manageAccount","managePayouts","managePayments","viewReports","manageSettings"],Marketing:["viewDashboard","viewMarketing","viewAnalytics","viewMore","manageAccount","sendNotifications","manageTemplates","managePrograms","managePromotions","manageFrontend"]}}};var a=require("../../../webpack-runtime.js");a.C(e);var n=e=>a(a.s=e),i=a.X(0,[8948,5059],()=>n(63524));module.exports=i})();