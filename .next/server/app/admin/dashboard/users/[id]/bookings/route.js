"use strict";(()=>{var e={};e.id=6526,e.ids=[6526],e.modules={92509:e=>{e.exports=require("firebase-admin")},60325:e=>{e.exports=require("firebase-admin/app")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5519:(e,r,a)=>{a.r(r),a.d(r,{originalPathname:()=>c,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>l});var n={};a.r(n),a.d(n,{GET:()=>m});var i=a(49303),s=a(88716),t=a(60670),o=a(87070),d=a(6128);async function m(e,{params:r}){try{let{adminDb:a}=(0,d.IW)(),n=e.headers.get("Authorization");if(!n)return o.NextResponse.json({message:"No authorization token provided"},{status:401});let i=n.split("Bearer ")[1],{uid:s}=await (0,d.y3)(i),t=r.id;if(!t)return o.NextResponse.json({message:"User ID is required"},{status:400});s!==t&&await (0,d.FH)(i,"manageUsers");let m=(await a.collection("bookings").where("userId","==",t).orderBy("createdAt","desc").get()).docs.map(e=>({id:e.id,...e.data()}));return o.NextResponse.json(m)}catch(a){console.error(`API Error fetching bookings for user ${r.id}:`,a);let e=a.message.includes("Permission Denied")?403:500;return o.NextResponse.json({message:a.message||"Internal Server Error"},{status:e})}}let u=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/admin/dashboard/users/[id]/bookings/route",pathname:"/admin/dashboard/users/[id]/bookings",filename:"route",bundlePath:"app/admin/dashboard/users/[id]/bookings/route"},resolvedPagePath:"/root/app/src/app/admin/dashboard/users/[id]/bookings/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:l,serverHooks:p}=u,c="/admin/dashboard/users/[id]/bookings/route";function v(){return(0,t.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:l})}},6128:(e,r,a)=>{a.d(r,{FH:()=>u,IW:()=>d,y3:()=>m});var n=a(92509),i=a.n(n),s=a(60325),t=a(89155);let o=null;function d(){if(!o)throw Error("Firebase Admin SDK is not initialized. Check server logs and environment variables.");return o}!function(){if(o)return;let e=process.env.FIREBASE_PRIVATE_KEY;if(!e||!process.env.FIREBASE_CLIENT_EMAIL){console.error("CRITICAL ERROR: Firebase Admin credentials are not fully set in environment variables. Admin features will fail.");return}let r={projectId:"studio-8506488239-824d2",clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:e.replace(/\\n/g,"\n")};try{let e=(0,s.getApps)().length?(0,s.getApps)()[0]:i().initializeApp({credential:i().credential.cert(r),databaseURL:"https://studio-8506488239-824d2.firebaseio.com"});o={adminApp:e,adminDb:i().firestore(e),adminAuth:i().auth(e)},console.log("Firebase Admin SDK initialized successfully.")}catch(e){console.error("Firebase Admin SDK initialization error:",e.message)}}();let m=e=>{let{adminAuth:r}=d();return r.verifyIdToken(e)},u=async(e,r)=>{let{adminDb:a}=d(),n=await m(e),i=(await a.doc(`users/${n.uid}`).get()).data();if(!i)throw Error(`Permission Denied: User with UID ${n.uid} not found in Firestore.`);let s=i.role;if(!s||!t._[s])throw Error(`Permission Denied: User role '${s}' is not defined or has no permissions.`);if(!t._[s]?.includes(r))throw Error(`Permission Denied: User with role '${s}' does not have the required '${r}' permission.`);return!0}},89155:(e,r,a)=>{a.d(r,{_:()=>n});/**
 * @project Engraced Smiles
 * @author Daniel Innocent <@mdtbmw>
 * @copyright Copyright (c) 2024. All rights reserved.
 * This software is the exclusive property of Daniel Innocent.
 * A license has been granted to Mr. Ismail Muhammed for resale to Engraced Smiles.
 */let n={Manager:["viewDashboard","viewOperations","viewFinancials","viewAnalytics","manageShipments","manageUsers","manageDrivers","viewMore","manageAccount","manageTeam","managePayouts","managePayments","sendNotifications","viewReports","manageTemplates","managePrograms","managePromotions","manageSupport","manageEmergencies","manageSettings","manageFrontend","manageSystem","viewMarketing","manageInventory"],Support:["viewDashboard","viewOperations","manageShipments","manageUsers","manageDrivers","viewMore","manageAccount","manageSupport","manageEmergencies"],Finance:["viewDashboard","viewFinancials","viewAnalytics","viewMore","manageAccount","managePayouts","managePayments","viewReports","manageSettings"],Marketing:["viewDashboard","viewMarketing","viewAnalytics","viewMore","manageAccount","sendNotifications","manageTemplates","managePrograms","managePromotions","manageFrontend"]}}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),n=r.X(0,[8948,5059],()=>a(5519));module.exports=n})();