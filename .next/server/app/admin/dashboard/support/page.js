(()=>{var e={};e.id=2129,e.ids=[2129],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},83122:e=>{"use strict";e.exports=require("undici")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},61047:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),s(73330),s(86120),s(73766),s(35866);var t=s(23191),a=s(88716),i=s(37922),n=s.n(i),d=s(95231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);s.d(r,l);let o=["",{children:["admin",{children:["dashboard",{children:["support",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,73330)),"/root/app/src/app/admin/dashboard/support/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,86120)),"/root/app/src/app/admin/dashboard/layout.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,73766)),"/root/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/root/app/src/app/admin/dashboard/support/page.tsx"],u="/admin/dashboard/support/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/dashboard/support/page",pathname:"/admin/dashboard/support",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6764:(e,r,s)=>{Promise.resolve().then(s.bind(s,94923))},84786:(e,r,s)=>{Promise.resolve().then(s.bind(s,45501))},86333:(e,r,s)=>{"use strict";s.d(r,{Z:()=>t});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(62881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},94923:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>l});var t=s(10326),a=s(49260),i=s(35047);s(17577);var n=s(15971),d=s(87321);/**
 * @project Engraced Smiles
 * @author Daniel Innocent <@mdtbmw>
 * @copyright Copyright (c) 2024. All rights reserved.
 * This software is the exclusive property of Daniel Innocent.
 * A license has been granted to Mr. Ismail Muhammed for resale to Engraced Smiles.
 */function l({children:e}){let{user:r,loading:s}=(0,a.a)();return((0,i.useRouter)(),s||!r||"admin"!==r.userType)?t.jsx(n.Preloader,{}):(0,t.jsxs)("div",{className:"flex flex-col h-dvh",children:[t.jsx("main",{className:"flex-1 overflow-y-auto pb-24",children:e}),t.jsx(d.h,{})]})}},45501:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>b});var t=s(10326),a=s(3594),i=s(38443),n=s(91664),d=s(41190),l=s(3236),o=s(49260),c=s(51223),u=s(86333),p=s(71992),m=s(35047),x=s(17577),h=s(76),f=s(14592),g=s(38227);let v=({convo:e,onSelect:r,isActive:s})=>(0,t.jsxs)("div",{className:(0,c.cn)("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors",s?"bg-primary/10":"hover:bg-muted/50"),onClick:r,children:[(0,t.jsxs)(a.qE,{className:"h-12 w-12 border-2 border-primary/20",children:[t.jsx(a.F$,{src:e.userAvatar}),t.jsx(a.Q5,{children:e.userName[0]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx("p",{className:"font-bold truncate",children:e.userName}),e.lastMessage?.createdAt&&t.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:new Date(1e3*e.lastMessage.createdAt.seconds).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsxs)("div",{className:"flex justify-between items-start mt-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e.lastMessage?.text||"No messages yet."}),e.unreadByAdmin>0&&t.jsx(i.C,{className:"bg-primary h-5 w-5 p-0 flex items-center justify-center text-xs",children:e.unreadByAdmin})]})]})]}),j=({conversation:e,messages:r,onSendMessage:s,onBack:i})=>{let[o,m]=(0,x.useState)(""),h=(0,x.useRef)(null);return(0,x.useEffect)(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[r]),(0,t.jsxs)("div",{className:"flex flex-col h-full bg-background",children:[(0,t.jsxs)("header",{className:"flex items-center p-4 border-b border-border/50 shrink-0",children:[t.jsx(n.z,{variant:"ghost",size:"icon",onClick:i,className:"mr-2 md:hidden",children:t.jsx(u.Z,{className:"h-5 w-5"})}),(0,t.jsxs)(a.qE,{className:"h-10 w-10 mr-3",children:[t.jsx(a.F$,{src:e.userAvatar}),t.jsx(a.Q5,{children:e.userName[0]})]}),t.jsx("div",{className:"flex-1",children:t.jsx("h2",{className:"font-bold",children:e.userName})})]}),(0,t.jsxs)(l.x,{className:"flex-1",children:[t.jsx("div",{className:"p-4 space-y-6",children:r.map(r=>(0,t.jsxs)("div",{className:(0,c.cn)("flex items-end gap-2 w-full",r.senderId!==e.userId?"justify-end":"justify-start"),children:[r.senderId===e.userId&&(0,t.jsxs)(a.qE,{className:"h-8 w-8",children:[t.jsx(a.F$,{src:e.userAvatar}),t.jsx(a.Q5,{children:e.userName[0]})]}),t.jsx("div",{className:(0,c.cn)("max-w-[75%] rounded-2xl p-3 shadow-sm",r.senderId!==e.userId?"bg-primary text-primary-foreground rounded-br-none":"bg-card rounded-bl-none"),children:t.jsx("p",{className:"text-sm",children:r.text})})]},r.id))}),t.jsx("div",{ref:h})]}),t.jsx("footer",{className:"p-4 border-t border-border/50 bg-background shrink-0",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.trim()&&(s(o.trim()),m(""))},className:"relative",children:[t.jsx(d.I,{placeholder:"Type a message...",className:"h-12 pr-12 rounded-full bg-card",value:o,onChange:e=>m(e.target.value)}),t.jsx(n.z,{type:"submit",size:"icon",className:"absolute top-1/2 right-1.5 -translate-y-1/2 rounded-full h-9 w-9 bg-primary",children:t.jsx(p.Z,{className:"h-5 w-5"})})]})})]})};function b(){let e=(0,m.useRouter)(),{user:r}=(0,o.a)(),[s,a]=(0,x.useState)([]),[i,d]=(0,x.useState)(null),[p,b]=(0,x.useState)([]),[N,y]=(0,x.useState)(!0),[w,q]=(0,x.useState)(!1),P=(0,h.ad)(f.default),S=async e=>{if(!r||!i)return;let s=(0,h.hJ)(P,"conversations",i.id,"messages"),t=(0,h.JU)(P,"conversations",i.id),a={conversationId:i.id,senderId:r.id,text:e,createdAt:(0,h.Bt)(),receiverId:i.userId},n={text:e,createdAt:new Date};try{await (0,h.ET)(s,a),await (0,h.r7)(t,{lastMessage:n,unreadByUser:(0,h.nP)(1)})}catch(e){console.error("Error sending message:",e)}};return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 h-dvh",children:[t.jsx("div",{className:(0,c.cn)("hidden md:flex md:flex-col",i&&"md:hidden lg:flex"),children:t.jsx(()=>(0,t.jsxs)("div",{className:"h-full flex flex-col border-r border-border/50",children:[(0,t.jsxs)("header",{className:"flex items-center justify-center p-4 sticky top-0 bg-background z-10 border-b border-border/50 shrink-0",children:[t.jsx(n.z,{variant:"ghost",size:"icon",onClick:()=>e.back(),className:"mr-2 absolute left-4",children:t.jsx(u.Z,{className:"h-5 w-5"})}),t.jsx("h1",{className:"text-xl font-bold",children:"Support Center"})]}),t.jsx(l.x,{className:"flex-1",children:t.jsx("div",{className:"p-2 space-y-1",children:N?Array.from({length:5}).map((e,r)=>t.jsx(g.O,{className:"h-20 w-full"},r)):s.length>0?s.map(e=>t.jsx(v,{convo:e,onSelect:()=>d(e),isActive:i?.id===e.id},e.id)):t.jsx("p",{className:"text-center text-muted-foreground p-8",children:"No conversations yet."})})})]}),{})}),t.jsx("div",{className:(0,c.cn)("md:col-span-2 lg:col-span-3",!i&&"hidden md:flex md:items-center md:justify-center",i&&"block"),children:i?t.jsx(j,{conversation:i,messages:p,onSendMessage:S,onBack:()=>d(null)}):(0,t.jsxs)("div",{className:"text-center text-muted-foreground",children:[t.jsx("p",{className:"text-lg font-semibold",children:"Select a conversation"}),t.jsx("p",{children:"Choose a conversation from the left to start chatting."})]})})]})}},3594:(e,r,s)=>{"use strict";s.d(r,{F$:()=>l,Q5:()=>o,qE:()=>d});var t=s(10326),a=s(17577),i=s(4150),n=s(51223);let d=a.forwardRef(({className:e,...r},s)=>t.jsx(i.fC,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...r}));d.displayName=i.fC.displayName;let l=a.forwardRef(({className:e,...r},s)=>t.jsx(i.Ee,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",e),...r}));l.displayName=i.Ee.displayName;let o=a.forwardRef(({className:e,...r},s)=>t.jsx(i.NY,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...r}));o.displayName=i.NY.displayName},38227:(e,r,s)=>{"use strict";s.d(r,{O:()=>i});var t=s(10326),a=s(51223);function i({className:e,...r}){return t.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e),...r})}},86120:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>n,__esModule:()=>i,default:()=>d});var t=s(68570);let a=(0,t.createProxy)(String.raw`/root/app/src/app/admin/dashboard/layout.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let d=(0,t.createProxy)(String.raw`/root/app/src/app/admin/dashboard/layout.tsx#default`)},73330:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>n,__esModule:()=>i,default:()=>d});var t=s(68570);let a=(0,t.createProxy)(String.raw`/root/app/src/app/admin/dashboard/support/page.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let d=(0,t.createProxy)(String.raw`/root/app/src/app/admin/dashboard/support/page.tsx#default`)},4150:(e,r,s)=>{"use strict";s.d(r,{Ee:()=>b,NY:()=>N,fC:()=>j});var t=s(17577),a=s(93095),i=s(55049),n=s(65819),d=s(77335),l=s(10326),o="Avatar",[c,u]=(0,a.b)(o),[p,m]=c(o),x=t.forwardRef((e,r)=>{let{__scopeAvatar:s,...a}=e,[i,n]=t.useState("idle");return(0,l.jsx)(p,{scope:s,imageLoadingStatus:i,onImageLoadingStatusChange:n,children:(0,l.jsx)(d.WV.span,{...a,ref:r})})});x.displayName=o;var h="AvatarImage",f=t.forwardRef((e,r)=>{let{__scopeAvatar:s,src:a,onLoadingStatusChange:o=()=>{},...c}=e,u=m(h,s),p=function(e,r){let[s,a]=t.useState("idle");return(0,n.b)(()=>{if(!e){a("error");return}let s=!0,t=new window.Image,i=e=>()=>{s&&a(e)};return a("loading"),t.onload=i("loaded"),t.onerror=i("error"),t.src=e,r&&(t.referrerPolicy=r),()=>{s=!1}},[e,r]),s}(a,c.referrerPolicy),x=(0,i.W)(e=>{o(e),u.onImageLoadingStatusChange(e)});return(0,n.b)(()=>{"idle"!==p&&x(p)},[p,x]),"loaded"===p?(0,l.jsx)(d.WV.img,{...c,ref:r,src:a}):null});f.displayName=h;var g="AvatarFallback",v=t.forwardRef((e,r)=>{let{__scopeAvatar:s,delayMs:a,...i}=e,n=m(g,s),[o,c]=t.useState(void 0===a);return t.useEffect(()=>{if(void 0!==a){let e=window.setTimeout(()=>c(!0),a);return()=>window.clearTimeout(e)}},[a]),o&&"loaded"!==n.imageLoadingStatus?(0,l.jsx)(d.WV.span,{...i,ref:r}):null});v.displayName=g;var j=x,b=f,N=v}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[8948,8172,1915,4263,9691,5911,1244,1228,6999,2021,7802,8422],()=>s(61047));module.exports=t})();